class Test

	def main is shared
		.check('-correct-source:case')
		.check('-correct-source')
	
	def check(opt as String) is shared
		using file = File.createText('_correct-case.cobra')
			print to file
				print 'class X'
				print '    var _s as string'
				print '    def foo(o as object, s as string)'
				print '        _s = "aoeu"'
				print '        _s = s'
				print '        s = s.trim'
				print '        print s'
				print '    def foo(d as dictionary<of String, int>)'
				print '        pass'
				print '    def bar(b as system.Object)'
				print '        pass'
				print '    def main is shared'
				print '        print "hello"'
		process as System.Diagnostics.Process?

		output = CobraCore.runCobraExe('[opt] _correct-case.cobra', out process)
		assert output.toLower.trim == 'hello'
		try, File.delete('_correct-case.cobra')
		catch
			pass
