use System.Diagnostics

class Test

	def main is shared
		Test().run

	def run
		bar = '-------------------------------------------------------------------'

		output = .runCobraExe('-test 106-cobra-test-program.cobra')
		try
			assert '** Test' in output
			assert '** main shared' in output
			assert '** Bar' in output
			assert '** baz' in output
		finally
			print bar
			print output
			print bar

		output = .runCobraExe('-test 108-cobra-test-library.cobra')
		try
			assert '** Test' in output
			assert '** run' in output
			assert '** Bar' in output
			assert '** baz' in output
		finally
			print bar
			print output
			print bar

	def runCobraExe(args as String) as String
		p as System.Diagnostics.Process?
		return CobraCore.runCobraExe(args, out p)
